{% extends 'headfoot.html' %}
{% block title %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
<title>DataExtractor | Home</title>
{% endblock title %}
{% block body %}


<br><br><br>
{% for message in get_flashed_messages() %}
    <div class="alert alert-warning alert-dismissible fade show" role="alert" onclick="closeAlert(this)">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
{% endfor %}

<script>
    function closeAlert(alertElement) {
        alertElement.classList.remove("show");
        setTimeout(function() {
            alertElement.style.display = "none";
        }, 500);
    }
</script>
    {% if current_user.type == "User" %}
  <div class="container text-center my-5">

    <div class="col">
    {% if session.theme == 'light' %}
      <div class="shadow-lg p-3 mb-5 bg-body rounded">
    {% else %}
        <div class="shadow-lg p-3 mb-5 color-body rounded">
    {% endif %}
        <p><b>SELECT TEMPLATE (images/pdfs) </b></p>
        <form enctype="multipart/form-data" method="post"  class="theme-form {{ 'light-theme' if session.theme == 'light' else 'dark-theme' }}">
          <div class="input-group">
            <input id="file" name="file" type="file" multiple class="form-control" accept=".pdf,.jpg,.png,.tiff,.tif,.PDF,.JPEG,.jpeg" required/>
<input type="text" placeholder="Enter Template Name Here" name="Temp_name" class="form-control" required>
              <select name="type" id="type" class="form-control">
                      <option value="text" selected>Text</option>
                          <option value="table">Table</option>
                    </select>
              <select name="language" id="language" class="form-control">
                          <option value="ara">Arabic</option>
                      <option value="eng" selected> English</option>
                          <option value="fra">French</option>
                          <option value="deu">German</option>
                          <option value="guj">Gujarati</option>
                          <option value="hin">Hindi</option>
                          <option value="kan">Kannada</option>
                          <option value="tam">Tamil</option>
                          <option value="tel">Telugu</option>
                    </select>
<button type="submit" class="btn btn-dark"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                fill="currentColor" class="bi bi-receipt" viewBox="0 0 16 16">
                <path
                  d="M1.92.506a.5.5 0 0 1 .434.14L3 1.293l.646-.647a.5.5 0 0 1 .708 0L5 1.293l.646-.647a.5.5 0 0 1 .708 0L7 1.293l.646-.647a.5.5 0 0 1 .708 0L9 1.293l.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .801.13l.5 1A.5.5 0 0 1 15 2v12a.5.5 0 0 1-.053.224l-.5 1a.5.5 0 0 1-.8.13L13 14.707l-.646.647a.5.5 0 0 1-.708 0L11 14.707l-.646.647a.5.5 0 0 1-.708 0L9 14.707l-.646.647a.5.5 0 0 1-.708 0L7 14.707l-.646.647a.5.5 0 0 1-.708 0L5 14.707l-.646.647a.5.5 0 0 1-.708 0L3 14.707l-.646.647a.5.5 0 0 1-.801-.13l-.5-1A.5.5 0 0 1 1 14V2a.5.5 0 0 1 .053-.224l.5-1a.5.5 0 0 1 .367-.27zm.217 1.338L2 2.118v11.764l.137.274.51-.51a.5.5 0 0 1 .707 0l.646.647.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.509.509.137-.274V2.118l-.137-.274-.51.51a.5.5 0 0 1-.707 0L12 1.707l-.646.647a.5.5 0 0 1-.708 0L10 1.707l-.646.647a.5.5 0 0 1-.708 0L8 1.707l-.646.647a.5.5 0 0 1-.708 0L6 1.707l-.646.647a.5.5 0 0 1-.708 0L4 1.707l-.646.647a.5.5 0 0 1-.708 0l-.509-.51z" />
                <path
                  d="M3 4.5a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5zm8-6a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5z" />
              </svg><b class="mx-2">Proceed &#8594</b></button>
          </div>
        </form>

      </div>

      <h5 class="container"><b>Saved Templates({{total}})</b></h5><br>



      {%if Data%}
          {% if session.theme == 'light' %}
            <p class="text-dark" id="basic-addon2"><b>Search Template Name</b></p>
          {% else %}
              <p class="text-light" id="basic-addon2"><b>Search Template Name</b></p>
          {% endif %}
      <div class="input-group mb-3">

        <input type="text" class="form-control" placeholder="Search template name" aria-label="Recipient's username"
          aria-describedby="basic-addon2" id="Searchinput" onkeyup="Search()">

      </div>
    </div>

  </div>

  </div>

  </div>

  <table class="table table-striped container" id="SavedTable">
    <thead>
      <tr>
        <th scope="col">SR NO</th>
        <th scope="col">Template Name</th>
        <th scope="col">Date</th>
        <th scope="col">Time</th>
        <th scope="col">Day</th>
        <th scope="col">Template format</th>
        <th scope="col">Apply on folder</th>
          <th scope="col">View</th>
        <!--<th scope="col">Edit</th>-->
        <th scope="col">Delete</th>


      </tr>
      <th id="msg">
        <div class="alert alert-primary" role="alert">
          Not Found
        </div>
      </th>
    </thead>
    <tbody class="imgs">




      {%for d in Data%}

      <tr>

        <th scope="row">{{loop.index}}</th>
        <td scope="col">{{d.Tem_name}}</td>
        <td scope="col">{{d.Date}}</td>
        <td scope="col">{{d.Time}}</td>
        <td scope="col">{{d.Day}}</td>
        <td scope="col">{{d.Tem_format}}</td>





        <td><b class="btn btn-dark"><a href="/apply/{{d.cord_id}}?token={{token}}" class="nav-link">Apply</a></b></td>

         <td>
    <b class="btn btn-warning">
        <a href="{{ url_for('view_image',folder=d.folder) }}" target="_blank" class="nav-link">View</a>
    </b>
</td>



        <td><b class="btn btn-danger"><a href="/delete/{{d.cord_id}}?token={{token}}"
              class="nav-link">Delete</a></b></td>
      </tr>
      {%endfor%}

    </tbody>
  </table>
  {% else %}


  <div class="alert alert-danger" role="alert">
    Templates are not available
  </div>


  {% endif %}
<script>
$(document).ready(function() {
    $('.view-image').on('click', function() {
        var folder = $(this).data('filename');
        var imageUrl = '/images/' + folder;

        $('#imageModal').find('.modal-body img').attr('src', imageUrl);
        $('#imageModal').modal('show');
    });
});

</script>
<div class="modal fade" id="imageModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">View Image</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <img src="" class="img-fluid" alt="Image">
            </div>
        </div>
    </div>
</div>



  <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel">
    <div class="offcanvas-header">
      <h5 id="offcanvasRightLabel">Instructions</h5>
      <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
      <li><b>Apply on folder</b>: It is use to apply previous template on the new folder.</li>
      <br>
      <li><b>Delete</b>: It is use to delete particular template from the table.</li>
      <br>
      <li><b>Select Template(images/pdfs)</b>: This section is basically use for the mark new template. you need to
        select template(image or pdf) from the system and click on the Mark new template button.</li>
      <br>
      <li><b>Logout</b>:It is use to logout from the application.</li>
    </div>
  </div>
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>



<script>
  document.querySelectorAll(".imgs span").forEach(image =>{
    image.onclick=()=>{
      document.querySelector('.popup-imag').style.display="block";
      document.querySelector('.popup-pdf').style.display="none";
      document.querySelector('.popup-imag img').src=image.getAttribute("value");
    }

document.querySelector('.popup-imag span').onclick =()=>{
      document.querySelector('.popup-imag').style.display="none";
     }

     document.querySelector('.popup-pdf span').onclick =()=>{
      document.querySelector('.popup-pdf').style.display="none";
     }
  });
    document.querySelectorAll(".imgs button").forEach(pdf =>{
      pdf.onclick=()=>{
         document.querySelector('.popup-pdf').style.display="block";
        document.querySelector('.popup-imag').style.display="none";

        document.querySelector('.popup-pdf iframe').src=pdf.getAttribute("value");
      }

   document.querySelector('.popup-imag span').onclick =()=>{
    document.querySelector('.popup-imag').style.display="none";
   }


   document.querySelector('.popup-pdf span').onclick =()=>{
    document.querySelector('.popup-pdf').style.display="none";
   }

  });
</script>
    {% else %}
    <div class="container">
          <div class="row">
          <div class="col-lg-4 col-md-6 mb-4">
                {% if session.theme == 'light' %}
         <div class="card bg-light" style="height: auto;">
     {% else %}
         <div class="card bg-dark" style="height: auto;">
     {% endif %}
                  <div class="card-body">
                    <h5 class="card-title">Requested Users</h5>
                    <p class="card-text">
                        List of Requested users.
                    </p>
                    <a href="{{ url_for('requested_user') }}" class="btn btn-primary">Check</a>
                  </div>
                </div>
            </div>
          <div class="col-lg-4 col-md-6 mb-4">
                {% if session.theme == 'light' %}
         <div class="card bg-light" style="height: auto;">
     {% else %}
         <div class="card bg-dark" style="height: auto;">
     {% endif %}
                  <div class="card-body">
                    <h5 class="card-title">List Of Users</h5>
                    <p class="card-text">
                        List of Accepted users.
                    </p>
                    <a href="{{ url_for('registered_user') }}" class="btn btn-primary">Check</a>
                  </div>
                </div>
            </div>


              {% if current_user.type == "Admin" %}
              <div class="col-lg-4 col-md-6 mb-4">
                {% if session.theme == 'light' %}
         <div class="card bg-light" style="height: auto;">
     {% else %}
         <div class="card bg-dark" style="height: auto;">
     {% endif %}
                  <div class="card-body">
                    <h5 class="card-title">Create accounts</h5>
                    <p class="card-text">
                        Create Employee or Admin Accounts.
                    </p>
                    <a href="{{ url_for("signup") }}" class="btn btn-primary">Create</a>
                  </div>
                </div>
            </div>
                  {% endif %}
          </div>
    </div>
         <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel">
    <div class="offcanvas-header">
      <h5 id="offcanvasRightLabel">Instructions</h5>
      <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
      <li><b>Requested Users</b>: It will have the list of all requested users.</li>
      <br>
      <li><b>List Of Users</b>: It will have the list of all accepted users.</li>
      <br>
        {% if current_user.type == "Admin" %}
      <li><b>Create accounts</b>: This section is basically use for the create the new admin or employee account.</li>
      <br>
        {% endif %}
      <li><b>Logout</b>:It is use to logout from the application.</li>
    </div>
  </div>
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
    {% endif %}

  {% endblock body %}
{% if Data %}
    {% set sticky = True %}
{% endif %}
{% set showheader = true %}
